---
description: Reglas estrictas de seguridad backend
globs: ["app/**/*.php", "config/cors.php"]
alwaysApply: true
---

# Reglas – Seguridad

## Input
- Nunca confiar en datos del cliente
- Todo input debe pasar por Form Request

## CORS
- Solo permitir origen del frontend
- Nunca usar `'*'` en producción

## Rate Limiting
- Aplicar throttle a endpoints sensibles

## IDs Públicos
- No exponer IDs autoincrementales
- Preferir UUIDs o códigos únicos públicos

## Errores
- Nunca retornar stack traces
- Los errores deben pasar por manejo central:
  `app/Exceptions/Handler.php`
